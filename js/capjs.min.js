"use strict";!function(){const e="WPA",t=2712847316,i=3569595041,n=439041101,s=3569595041,l=65535,a=105,c=119,_=127,r=192,o=12,p=240,d=256,h=512,g=0,f=8,u=0,k=32,m=64,y=80,b=128,v=128,x=170,w=170,I=3,B=36488,S=7,L=64,N=128,A=512,O=0,U=[255,255,255,255,255,255],P=32,R=1,j=2,z=6,E=-1,C=1,M=2,G=3,D=4,T=0,J=1,W=2,Z=3,H=4,X=5,$=16,q=32,F=64,K=128,Q=6,V=168627466,Y=2989,ee=[2988,2989,19372,19373],te=9,ie=0,ne=[42,206,70,161],se=[42,206,70,161,121,160,114,51,131,55,39,171,89,51,179,98,69,55,17,71,167,207,50,127,141,105,128,192,137,94,94,152],le=62108,ae=62109,ce=[0,15,172],_e=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],re=(()=>{const e=new Uint8Array(4);return!((new Uint32Array(e.buffer)[0]=1)&e[0])})(),oe=[];for(let e=0;e<=255;++e){const t=e.toString(16).padStart(2,"0");oe.push(t)}function pe(e){const t=new Uint8Array(e),i=[];for(let e=0;e<t.length;++e)i.push(oe[t[e]]);return i.join("")}function de(e){return(e[0]|e[1]<<8)>>>0}function he(e){return(e[0]|e[1]<<8|e[2]<<16|e[3]<<24)>>>0}function ge(e){return BigInt(e[0])|BigInt(e[1])<<BigInt(8)|BigInt(e[2])<<BigInt(16)|BigInt(e[3])<<BigInt(24)|BigInt(e[4])<<BigInt(32)|BigInt(e[5])<<BigInt(40)|BigInt(e[6])<<BigInt(48)|BigInt(e[7])<<BigInt(56)}function fe(e){return((65280&e)>>>8|(255&e)>>>0<<8)>>>0}function ue(e){return((4278190080&e)>>>24|(16711680&e)>>>8|(65280&e)>>>0<<8|(255&e)>>>0<<24)>>>0}function ke(e){return(e&BigInt(0xff00000000000000))>>BigInt(56)|(e&BigInt(0xff000000000000))>>BigInt(40)|(e&BigInt(0xff0000000000))>>BigInt(24)|(e&BigInt(0xff00000000))>>BigInt(8)|(e&BigInt(4278190080))<<BigInt(8)|(e&BigInt(16711680))<<BigInt(24)|(e&BigInt(65280))<<BigInt(40)|(e&BigInt(255))<<BigInt(56)}function me(e){return((2147483648^(e=(4294967295&e)>>>0))>>>0)-2147483648}BigInt.prototype.toJSON=function(){return this.toString()};class ye{constructor(){this.essids={},this.pmkids={},this.excpkts={},this.hcwpaxs={},this.pcapng_info={},this.passwords=[]}essid_add(e,t,i){this.essids.hasOwnProperty(e)||0!=i&&(this.essids[e]={bssid:e,essid:t,essid_len:i})}pmkid_add(e,t,i,n){this.pmkids[[e,t]]={mac_ap:e,mac_sta:t,pmkid:i,akm:n}}excpkt_add(e,t,i,n,s,l,a,c,_,r,o){if(a.toString()==Array(32).fill(0).toString())return;let p,d=s,h=l;p=e==C||e==G?"ap":"sta",this.excpkts.hasOwnProperty(d)||(this.excpkts[d]={}),this.excpkts[d].hasOwnProperty(h)||(this.excpkts[d][h]={}),this.excpkts[d][h].hasOwnProperty(p)||(this.excpkts[d][h][p]=[]),this.excpkts[d][h][p].push({excpkt_num:e,tv_sec:t,tv_usec:i,tv_abs:1e3*t*1e3+i,replay_counter:n,mac_ap:d,mac_sta:h,nonce:a,eapol_len:c,eapol:_,keyver:r,keymic:o})}hcwpaxs_add(e,t,i,n,s,l,a,c,_){let r;if("01"==t){if(r=i,this.hcwpaxs[r])return;this.hcwpaxs[r]={signature:e,type:t,pmkid_or_mic:pe(i),mac_ap:pe(n),mac_sta:pe(s),essid:pe(l),anonce:"",eapol:"",message_pair:""}}else if("02"==t){if(r=[i,_],this.hcwpaxs[r])return;this.hcwpaxs[r]={signature:e,type:t,pmkid_or_mic:pe(i),mac_ap:pe(n),mac_sta:pe(s),essid:pe(l),anonce:pe(a),eapol:pe(c),message_pair:_.toString(16).padStart(2,0)}}}pcapng_info_add(e,t){this.pcapng_info[e]=t}password_add(e){for(var t=e.length-1;t>=0;t--){var i=e[t];if(i<32||i>126)return void this.passwords.push("$HEX["+pe(e)+"]")}this.passwords.push((new TextDecoder).decode(new Uint8Array(e)))}}window.capJS=class{constructor(e,t,i,n,s,l){this.bytes=new Uint8Array(e),this.format=t,this.best_only=i,this.export_unauthenticated=n,this.ignore_ts=s,this.ignore_ie=l,this.pos=0,this.db=new ye}Analysis(){"pcap"==this.format||"cap"==this.format?this._pcap2hcwpax():"pcapng"==this.format?this._pcapng2hcwpax():"pcap.gz"==this.format||"cap.gz"==this.format?(this.__Decompress(),this._pcap2hcwpax()):"pcapng.gz"==this.format?(this.__Decompress(),this._pcapng2hcwpax()):this._Log("Unsupported capture file")}Get(e){if("hcwpax"==e)return this.db.hcwpaxs}Getf(e){let t="";return"hcwpax"==e&&Object.values(this.db.hcwpaxs).forEach(function(e){t+=Object.values(e).join("*"),t+="\n"}),t}GetPasswords(){return[...new Set(this.db.passwords)].join("\n")}_Log(...e){console.log(...e)}__Decompress(){try{this.bytes=pako.inflate(this.bytes)}catch(e){this._Log(e)}}__Tell(){return this.pos}__Seek(e){this.pos=e}__Read(e){let t=this.bytes.slice(this.pos,this.pos+e);return this.pos+=e,t}__get_essid_from_tag(e,t,i){if(i>t.caplen)return[-1,NaN];let n=t.caplen-i,s=e.slice(i,i+n),l=0,a=s.length;for(var c,_;l<a&&!(l+2>=a)&&(c=s[l],_=s[l+=1],!((l+=1)+_>=a));){if(c==O&&_<=P){let e={};return e.essid=new Uint8Array(P),e.essid.set(s.slice(l,l+_)),e.essid_len=_,[0,e]}l+=_}return[-1,NaN]}__get_pmkid_from_packet(e,t){var i,n,s,l,a,c,_,r,o,p;if("EAPOL-M1"!=t){if("EAPOL-M2"==t)n=0;else if(t==u)n=28;else{if(t!=k)return;n=34}for(;null!=(l=e[n]);){if(a=e[n+1],48==l){for(_=de((c=e.slice(n+2,n+2+a)).slice(6,8)),re&&(_=fe(_)),n=8,n+=4*_,r=de(c.slice(n,n+2)),re&&(r=fe(r)),n+=2,s=0,i=0;i<r;i++)if(n+=4*i+4,(p=c.slice(n-4,n)).slice(0,3).toString()!=ce.toString()){s=1;break}if(1==s)break;for(o=de(c.slice(n+2,n+4)),re&&(o=fe(o)),n+=4,i=0;i<o;i++){n+=16*i+16;let e=c.slice(n-16,n);if(e.toString()!=_e.toString())return[e,p[3]]}break}n=n+2+a}}else for(p=NaN,n=0;null!=(l=e[n]);){if(a=e[n+1],221==l&&(c=e.slice(n+2,n+2+a)).slice(0,3).toString()==ce.toString()){let e=c.slice(4);if(e.toString()!=_e.toString())return[e,p]}break}}__handle_llc(e){return e.dsap!=x?-1:e.ssap!=w?-1:e.ctrl!=I?-1:e.ethertype!=B?-1:0}__handle_auth(e,t,i,n,s,l,a){let c=fe(e.length),_=fe(e.key_information),r=ke(e.replay_counter),o=fe(e.wpa_key_data_length);if(0==c)return[-1,NaN];var p;p=(_&N)>>>0?(_&L)>>>0?G:C:(_&A)>>>0?D:M;let d={};return d.nonce=new Uint8Array(32),d.nonce.set(e.wpa_key_nonce),d.replay_counter=r,d.excpkt_num=p,d.eapol_len=i+o,l+d.eapol_len>a?[-1,NaN]:i+o>256?[-1,NaN]:(d.eapol=new Uint8Array(256),d.eapol.set(t),d.eapol.set(s.slice(0,o),i),d.keymic=e.wpa_key_mic,d.keyver=(_&S)>>>0,p!=G&&p!=D||(d.replay_counter-=BigInt(1)),[0,d])}*__read_blocks(){for(;;){let[e,t]=[this.__Read(4),this.__Read(4)];if(!e.length||!t.length)break;[e,t]=[he(e),he(t)],re&&(t=ue(t));let i=t-12;re&&(e=ue(e),t=ue(t)),yield{block_type:e,block_length:t,block_body:this.__Read(i),block_length_2:he(this.__Read(4))}}}*__read_options(e,t){for(;;){var i={};if(i.code=e.slice(0,2),i.length=e.slice(2,4),!i.code.length||!i.length.length)break;if(i.code=de(i.code),i.length=de(i.length),re&&(i.code=fe(i.code),i.length=fe(i.length)),t&&(i.code=fe(i.code),i.length=fe(i.length)),i.code==ie)break;let a=i.length+(s=-i.length,l=4,s-Math.floor(s/l)*l);if(i.value=e.slice(4,4+a),ee.includes(i.code)){if(i.value.slice(0,4).toString()==ne.toString()&&i.value.slice(4,36).toString()==se.toString())for(var n of this.__read_options(i.value.slice(36),t))yield n;e=e.slice(4+a)}else e=e.slice(4+a),yield i}var s,l}__read_custom_block(e,t){let i,n,s;if(e.slice(0,4).toString()==ne.toString()&&e.slice(4,36).toString()==se.toString())for(var l of(i="hcxdumptool",n=void 0,s=[],this.__read_options(e.slice(36),t)))l.code==le&&(l.value=ge(l.value),re&&(l.value=ke(l.value)),t&&(l.value=ke(l.value))),s.push(l);return[i,n,s]}__process_packet(e,t){if(t.caplen<24)return;let i={frame_control:de(e.slice(0,2)),addr1:[e[4],e[5],e[6],e[7],e[8],e[9]],addr2:[e[10],e[11],e[12],e[13],e[14],e[15]],addr3:[e[16],e[17],e[18],e[19],e[20],e[21]]};re&&(i.frame_control=fe(i.frame_control));let n=i.frame_control;if((n&o)>>>0==g){var s,l;let a=(n&p)>>>0;if(a==b){if([s,l]=this.__get_essid_from_tag(e,t,36),-1==s)return;if(this.db.password_add(l.essid.slice(0,l.essid_len)),i.addr3==U)return;this.db.essid_add(i.addr3,l.essid,l.essid_len)}else if(a==m){if([s,l]=this.__get_essid_from_tag(e,t,24),-1==s)return;if(this.db.password_add(l.essid.slice(0,l.essid_len)),i.addr3==U)return;this.db.essid_add(i.addr3,l.essid,l.essid_len)}else if(a==y){if([s,l]=this.__get_essid_from_tag(e,t,36),-1==s)return;if(this.db.password_add(l.essid.slice(0,l.essid_len)),i.addr3==U)return;this.db.essid_add(i.addr3,l.essid,l.essid_len)}else if(a==u){if([s,l]=this.__get_essid_from_tag(e,t,28),-1==s)return;if(this.db.password_add(l.essid.slice(0,l.essid_len)),i.addr3==U)return;this.db.essid_add(i.addr3,l.essid,l.essid_len);let n=i.addr3,c=n==i.addr1?i.addr2:i.addr1,_=this.__get_pmkid_from_packet(e,a);null!=_&&this.db.pmkid_add(n,c,_[0],_[1])}else if(a==k){if([s,l]=this.__get_essid_from_tag(e,t,34),-1==s)return;if(this.db.password_add(l.essid.slice(0,l.essid_len)),i.addr3==U)return;this.db.essid_add(i.addr3,l.essid,l.essid_len);let n=i.addr3,c=n==i.addr1?i.addr2:i.addr1,_=this.__get_pmkid_from_packet(e,a);null!=_&&this.db.pmkid_add(n,c,_[0],_[1])}}else if((n&o)>>>0==f){var a;let s=(n&(d|h)>>>0)>>>0==(d|h)>>>0;if(a=(n&p)>>>0==v?26:24,t.caplen<a+8)return;s&&(a+=6);let l={dsap:e[a],ssap:e[a+1],ctrl:e[a+2],ethertype:de(e.slice(a+6,a+8))};if(re&&(l.ethertype=fe(l.ethertype)),-1==this.__handle_llc(l))return;let o=a+8,g=e[o+1],f=de(e.slice(o+2,o+4));var c,_;if(re&&(f=fe(f)),3==g){if(e.slice(o).length<107)c=16,_=99;else{let t=de(e.slice(o+97,o+99)),i=de(e.slice(o+105,o+107));if(re&&(t=fe(t),i=fe(i)),f=fe(f),t=fe(t),i=fe(i),t+99==f+4)c=16,_=99;else{if(i+107!=f+4)return;c=24,_=107}}if(t.caplen<o+_)return;var r,x;if(16==c)r={length:de(e.slice(o+2,o+4)),key_information:de(e.slice(o+5,o+7)),replay_counter:ge(e.slice(o+9,o+17)),wpa_key_nonce:e.slice(o+17,o+49),wpa_key_mic:e.slice(o+81,o+97),wpa_key_data_length:de(e.slice(o+97,o+99))},(x=new Uint8Array(_)).set(e.slice(o,o+81)),x.set([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],81),x.set(e.slice(o+97,o+99),97);else{if(24!=c)return;r={length:de(e.slice(o+2,o+4)),key_information:de(e.slice(o+5,o+7)),replay_counter:ge(e.slice(o+9,o+17)),wpa_key_nonce:e.slice(o+17,o+49),wpa_key_mic:e.slice(o+81,o+105),wpa_key_data_length:de(e.slice(o+105,o+107))},(x=new Uint8Array(_)).set(e.slice(o,o+81)),x.set([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],81),x.set(e.slice(o+105,o+107),105)}re&&(r.length=fe(r.length),r.key_information=fe(r.key_information),r.replay_counter=ke(r.replay_counter),r.wpa_key_data_length=fe(r.wpa_key_data_length));let n=e.slice(o+_);var w,I;if([w,I]=this.__handle_auth(r,x,_,c,n,o,t.caplen),-1==w)return;if(I.excpkt_num==C||I.excpkt_num==G){if(this.db.excpkt_add(I.excpkt_num,t.tv_sec,t.tv_usec,I.replay_counter,i.addr2,i.addr1,I.nonce,I.eapol_len,I.eapol,I.keyver,I.keymic),I.excpkt_num==C){let e=this.__get_pmkid_from_packet(n,"EAPOL-M1");null!=e&&(isNaN(e[1])&&I.keyver>=1&&I.keyver<=3&&(e[1]=E),this.db.pmkid_add(i.addr2,i.addr1,e[0],e[1]))}}else if((I.excpkt_num==M||I.excpkt_num==D)&&(this.db.excpkt_add(I.excpkt_num,t.tv_sec,t.tv_usec,I.replay_counter,i.addr1,i.addr2,I.nonce,I.eapol_len,I.eapol,I.keyver,I.keymic),I.excpkt_num==M)){let e=this.__get_pmkid_from_packet(n,"EAPOL-M2");null!=e&&(isNaN(e[1])&&I.keyver>=1&&I.keyver<=3&&(e[1]=E),this.db.pmkid_add(i.addr1,i.addr2,e[0],e[1]))}}}}__read_pcap_file_header(){let e=this.__Read(24);if(!e.length)return;let n={magic:he(e.slice(0,4)),linktype:he(e.slice(20,24))};var s;if(re&&(n.magic=ue(n.magic),n.linktype=ue(n.linktype)),n.magic==t)s=0;else{if(n.magic!=i)return void this._Log("Invalid pcap header");s=1,n.linktype=ue(n.linktype)}if(n.linktype==a||n.linktype==c||n.linktype==_||n.linktype==r)return[n,s];this._Log("Unsupported linktype detected")}__read_pcap_packets(e,t){for(;;){let i=this.__Read(16);if(!i.length)break;let n={tv_sec:he(i.slice(0,4)),tv_usec:he(i.slice(4,8)),caplen:he(i.slice(8,12)),len:he(i.slice(12,16))};if(re&&(n.tv_sec=ue(n.tv_sec),n.tv_usec=ue(n.tv_usec),n.caplen=ue(n.caplen),n.len=ue(n.len)),t&&(n.tv_sec=ue(n.tv_sec),n.tv_usec=ue(n.tv_usec),n.caplen=ue(n.caplen),n.len=ue(n.len)),0==n.tv_sec&&0==n.tv_usec&&(this._Log("Zero value timestamps detected"),!this.ignore_ts))continue;if(n.caplen>=l||me(n.caplen)<0){this._Log("Oversized packet detected");continue}let s=this.__Read(n.caplen);if(e.linktype==c){if(n.caplen<144){this._Log("Could not read prism header");continue}let e={msgcode:he(s.slice(0,4)),msglen:he(s.slice(4,8))};if(re&&(e.msgcode=ue(e.msgcode),e.msglen=ue(e.msglen)),me(e.msglen)<0){this._Log("Oversized packet detected");continue}if(me(n.caplen-e.msglen)<0){this._Log("Oversized packet detected");continue}s=s.slice(e.msglen),n.caplen-=e.msglen,n.len-=e.msglen}else if(e.linktype==_){if(n.caplen<8){this._Log("Could not read radiotap header");continue}let e={it_version:s[0],it_len:de(s.slice(2,4)),it_present:he(s.slice(4,8))};if(re&&(e.it_len=fe(e.it_len),e.it_present=ue(e.it_present)),0!=e.it_version){this._Log("Invalid radiotap header");continue}s=s.slice(e.it_len),n.caplen-=e.it_len,n.len-=e.it_len}else if(e.linktype==r){if(n.caplen<8){this._Log("Could not read ppi header");continue}let e={pph_len:de(s.slice(2,4))};re&&(e.pph_len=fe(e.pph_len)),s=s.slice(e.pph_len),n.caplen-=e.pph_len,n.len-=e.pph_len}this.__process_packet(s,n)}}*__read_pcapng_file_header(){let e=this.__read_blocks();for(var t of e)if(t.block_type==V){let p=e.next().value;if(!p)break;let d={};d.magic=t.block_body.slice(0,4),d.linktype=p.block_body[0],re&&(d.magic=ue(d.magic),d.linktype=ue(d.linktype));let h=he(d.magic);var i;if(h==n)i=0;else{if(h!=s)continue;i=1,d.linktype=ue(d.linktype),this._Log("WARNING! BigEndian (Endianness) files are not well tested.")}for(var l of(d.section_options=[],this.__read_options(t.block_body.slice(16),i)))d.section_options.push(l);var o=6;for(var l of(d.interface_options=[],this.__read_options(p.block_body.slice(8),i)))l.code!=te||6==(o=l.value.slice(l.length))?d.interface_options.push(l):this._Log("WARNING! Unsupported if_tsresol");if(d.linktype!=a&&d.linktype!=c&&d.linktype!=_&&d.linktype!=r)continue;yield[d,i,o,e]}}__read_pcapng_packets(e,t,i,n){for(;;){let n=e.next().value;if(!n)break;if(n.block_type!=Q){if(n.block_type==Y){var s,a,o;[s,a,o]=this.__read_custom_block(n.block_body,i),"hcxdumptool"==s&&this.db.pcapng_info_add("hcxdumptool",o);continue}if(n.block_type==V){this.__Seek(this.__Tell()-n.block_length);break}continue}let p={},d=(BigInt(n.block_body[8])|BigInt(n.block_body[9])<<BigInt(8)>>BigInt(0)|BigInt(n.block_body[10])<<BigInt(16)>>BigInt(0)|BigInt(n.block_body[11])<<BigInt(24)>>BigInt(0)|BigInt(n.block_body[4])<<BigInt(32)>>BigInt(0)|BigInt(n.block_body[5])<<BigInt(40)>>BigInt(0)|BigInt(n.block_body[6])<<BigInt(48)>>BigInt(0)|BigInt(n.block_body[7])<<BigInt(56)>>BigInt(0))>>BigInt(0);if(p.caplen=he(n.block_body.slice(12,16)),p.len=he(n.block_body.slice(16,20)),re&&(d=ke(d),p.caplen=ue(p.caplen),p.len=ue(p.len)),i&&(d=ke(d),p.caplen=ue(p.caplen),p.len=ue(p.len)),[p.tv_sec,p.tv_usec]=[Number(d/BigInt(1e6)),Number(d%BigInt(1e6))],0==p.tv_sec&&0==p.tv_usec&&(this._Log("Zero value timestamps detected"),!this.ignore_ts))continue;if(p.caplen>=l||me(p.caplen)<0){this._Log("Oversized packet detected");continue}let h=n.block_body.slice(20,20+p.caplen);if(t.linktype==c){if(p.caplen<144){this._Log("Could not read prism header");continue}let e={msgcode:he(h.slice(0,4)),msglen:he(h.slice(4,8))};if(re&&(e.msgcode=ue(e.msgcode),e.msglen=ue(e.msglen)),me(e.msglen)<0){this._Log("Oversized packet detected");continue}if(me(p.caplen-e.msglen)<0){this._Log("Oversized packet detected");continue}h=h.slice(e.msglen),p.caplen-=e.msglen,p.len-=e.msglen}else if(t.linktype==_){if(p.caplen<8){this._Log("Could not read radiotap header");continue}let e={it_version:h[0],it_len:de(h.slice(2,4)),it_present:he(h.slice(4,8))};if(re&&(e.it_len=fe(e.it_len),e.it_present=ue(e.it_present)),0!=e.it_version){this._Log("Invalid radiotap header");continue}h=h.slice(e.it_len),p.caplen-=e.it_len,p.len-=e.it_len}else if(t.linktype==r){if(p.caplen<8){this._Log("Could not read ppi header");continue}let e={pph_len:de(h.slice(2,4))};re&&(e.pph_len=fe(e.pph_len)),h=h.slice(e.pph_len),p.caplen-=e.pph_len,p.len-=e.pph_len}this.__process_packet(h,p)}}__build(){var t;if(0!==Object.keys(this.db.essids).length)for(var i in this.db.essids){var n=this.db.essids[i];t={};let k=this.db.excpkts[n.bssid];if(!k)continue;for(var s in k){var l=k[s];let i=l.ap;if(i)for(var a in i){var c=i[a];let s=l.sta;if(s)for(var _ in s){var r=s[_];if(c.replay_counter!=r.replay_counter)continue;if(c.excpkt_num<r.excpkt_num){if(c.tv_abs>r.tv_abs)continue;if(c.tv_abs+1e3*R*1e3<r.tv_abs)continue}else{if(r.tv_abs>c.tv_abs)continue;if(r.tv_abs+1e3*R*1e3<c.tv_abs)continue}let l=255;if(c.excpkt_num==C&&r.excpkt_num==M){if(!(r.eapol_len>0))continue;l=T}else if(c.excpkt_num==C&&r.excpkt_num==D){if(!(r.eapol_len>0))continue;l=J}else if(c.excpkt_num==G&&r.excpkt_num==M)if(r.eapol_len>0)l=W;else{if(!(c.eapol_len>0))continue;l=Z}else if(c.excpkt_num==G&&r.excpkt_num==D)if(c.eapol_len>0)l=H;else{if(!(r.eapol_len>0))continue;l=X}else this._Log("BUG AP:"+c.excpkt_num+" STA:"+c.excpkt_num);let a=1;if(l==Z||l==H)continue;var o,p;for(var d in l==T&&(a=0,this.db.pcapng_info.hcxdumptool&&(o=!1,p=!1,this.db.pcapng_info.hcxdumptool.some(function(e){if(e.code==le?c.replay_counter==e.value&&(o=!0):e.code==ae&&c.nonce.toString()==e.value.toString()&&(p=!0),o&&p)return l=(l|$)>>>0,!0},this))),i){var h=i[d];c.nonce.slice(0,28).toString()==h.nonce.slice(0,28).toString()&&c.nonce.slice(28).toString()!=h.nonce.slice(28).toString()&&(l=(l|K)>>>0,c.nonce[31]!=h.nonce[31]?l=(l|q)>>>0:c.nonce[28]!=h.nonce[28]&&(l=(l|F)>>>0))}for(var g in s){var f=s[g];r.nonce.slice(0,28).toString()==f.nonce.slice(0,28).toString()&&r.nonce.slice(28).toString()!=f.nonce.slice(28).toString()&&(l=(l|K)>>>0,r.nonce[31]!=f.nonce[31]?l=(l|q)>>>0:r.nonce[28]!=f.nonce[28]&&(l=(l|F)>>>0))}if(0==a&&!this.export_unauthenticated)continue;let u={};u.message_pair=l,u.essid_len=n.essid_len,u.essid=n.essid,u.mac_ap=c.mac_ap,u.nonce_ap=c.nonce,u.mac_sta=r.mac_sta,u.nonce_sta=r.nonce,r.eapol_len>0?(u.keyver=r.keyver,u.keymic=r.keymic,u.eapol_len=r.eapol_len,u.eapol=r.eapol):(u.keyver=c.keyver,u.keymic=c.keymic,u.eapol_len=c.eapol_len,u.eapol=c.eapol),t[Math.abs(c.tv_abs-r.tv_abs)]=[e,"02",u.keymic,u.mac_ap,u.mac_sta,u.essid.slice(0,u.essid_len),u.nonce_ap,u.eapol.slice(0,u.eapol_len),u.message_pair]}}}for(var u in this.db.pmkids){let i=this.db.pmkids[u];i.mac_ap.toString()==n.bssid.toString()&&(!0===this.ignore_ie||[j,z,E].includes(i.akm))&&(t[0]=[e,"01",i.pmkid,i.mac_ap,i.mac_sta,n.essid.slice(0,n.essid_len),"","",""])}let m=Object.keys(t).length;if(0!==m)if(this._Log(pe(n.bssid)+": "+m+" eligible hs/pmkid found"),!0===this.best_only){let e=t[Math.min(...Object.keys(t))];this.db.hcwpaxs_add(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8])}else Object.values(t).forEach(function(e){this.db.hcwpaxs_add(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8])},this);else this._Log(pe(n.bssid)+": No eligible hs/pmkid found")}else this._Log("No Networks found")}_pcap2hcwpax(){var e,t;let i=this.__read_pcap_file_header();null!=i?([e,t]=i,this.__read_pcap_packets(e,t),this.__build()):this._Log("Could not read pcap header")}_pcapng2hcwpax(){var e,t,i,n;for([e,t,i,n]of this.__read_pcapng_file_header())this.__read_pcapng_packets(n,e,t,i);this.__build()}},window.capJS.version="0.2.0"}();